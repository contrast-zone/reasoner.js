<!DOCTYPE html>
<!--?xml version="1.0"?-->
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:svg="http://www.w3.org/2000/svg">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Exp-Log</title>
<script src="ace.js" type="text/javascript" charset="utf-8"></script>
<script src="../src/exp-log.js"></script>

<script id="buzz1" type="text/plain">
`
computation
    implicational propositional logic
    untyped lambda calculus
    Turing machine
    arithmetic

algorithms
    factorial
    prime numbers
    Euclid's greatest common divisor

planning
    monkey and banana (https://www.codepoc.io/blog/prolog/4935/prolog-program-for-monkey-and-banana)
    the wolf, the goat, the cabbage (https://cseweb.ucsd.edu/classes/fa09/cse130/misc/prolog/goat_etc.html)
`
</script>

<script id="buzz2" type="text/plain">
`
blocks world
tower of hanoi
expert system

sudoku
n-queens puzzle
n-coloring problem (four)
traveling salesman problem

roots
leaves
branching rules
branching nodes
root end
end leaf
mirror leaves analogy (root ends - Goal - leaves)

[second-order propositional logic](https://en.wikipedia.org/wiki/Second-order_propositional_logic)
[quantified propositional logic]
ordered logic - propositional ordering
[rule-based-programming-paradigm](en.wikipedia.org/wiki/Rule-based_system)
emphasize patterns
read rules from the Goal atom backwards - waterfall analogy (a continuous lake (input string) → ... → topmost continuous lake (output string) → ... → waterfall source (Goal))
analogy to CNF, positive logic - without ¬ and <->
minimalist
lightweight general compiling system

recursively applying rules to input expression until it reaches the goal expression
rules are substitution mechanism in a role of forming syntax constraints, function evaluation, or generally processing logical connectives.

imperative - compose a sequence of instructions that mutate states, then return selected states as a result of computation
functional - declare how can functions fit together, then compose them to compute a result
exp-log - declare expression transitions, then compose expressions from input to output to compute a result nearest to the Goal atom

npm search for logic programming

        +-----------+      +------+   +------------+
        ! root ends !--+-->! Goal !<--! end leaves !
        +-----------+  !   +------+   +-----+------+
                       !                    !
                       !                    !
                       +------ equals ------+

                  /\
                 /  \
                /    \
               / Goal \
              /^^^^^^^^\
             /          \
            /   output   \
           /^^^^^^^^^^^^^^\
          /                \
         /      input       \
         ^^^^^^^^^^^^^^^^^^^^ 

          Goal
           /\
          /  \
         /    \
        /output\
       /^^^^^^^^\
      /          \
     /            \
    /    input     \
    ^^^^^^^^^^^^^^^^ 

             Goal                          Goal                          Goal
              /\                            /\                            /\ 
             /\/\                          /\/\                          /\/\ 
            /\/\/\                        /\/\/\                        /\/\/\ 
           /\/\/\/\                      /\/\/\/\                      -output-
          /\/\/\/\/\                    /\/\/\/\/\                    /\/\/\/\/\ 
         /\/\/\/\/\/\                  /\/\/\/\/\/\                  /\/\/\/\/\/\ 
        /\/\/\/\/\/\/\                /\/\/\/\/\/\/\                /\/\/\/\/\/\/\ 
       /\/\/\/\/\/\/\/\              -----input------              -----input------
      /\/\/\/\/\/\/\/\/\            /\/\/\/\/\/\/\/\/\            /\/\/\/\/\/\/\/\/\ 
     /\/\/\/\/\/\/\/\/\/\          /\/\/\/\/\/\/\/\/\/\          /\/\/\/\/\/\/\/\/\/\ 
    /\/\/\/\/\/\/\/\/\/\/\        /\/\/\/\/\/\/\/\/\/\/\        /\/\/\/\/\/\/\/\/\/\/\ 
             ....                          ....                          ....
             
           figure 1                      figure 2                      figure 3


          Goal
           /\
          /  \
         +----+
         output  
       +--------+
      /          \
     /            \
    +--------------+
         input       
                                
`
</script>

<script id="theorems" type="text/plain">
`
(<a> /\ <b>) => <a>
(<a> /\ <b>) => <b>

<a> => (<a> \/ <b>)
<b> => (<a> \/ <b>)

((a -> b) /\ (c -> d)) <-> ((a \/ c) -> (b /\ d))
((a -> b) \/ (c -> d)) <-> ((a /\ c) -> (b \/ d))

((a -> b) \/ (a -> c)) <-> (a -> (b \/ c))
((a -> b) /\ (a -> c)) <-> (a -> (b /\ c))

((a -> c) \/ (b -> c)) <-> ((a /\ b) -> c)
((a -> c) /\ (b -> c)) <-> ((a \/ b) -> c)

(a -> b -> c) => ((a /\ b) -> c)

+-----------------------------+
! (a -> c) => ((a /\ b) -> c) !
! (a -> b) => (a -> (b \/ c)) !
+-----------------------------+

+-----------------------------------------+
! (a -> b) -> (a -> c) => (a -> (b /\ c)) !
! (a -> c) -> (b -> c) => ((a \/ b) -> c) !
+-----------------------------------------+
`
</script>

<script id="math-exp ruleset" type="text/plain">
["RULESET",
    ["IMPL", ["CONJ", ["SEQ", "sum"]], ["DISJ", ["SEQ", "goal"]]],
    
    ["IMPL", ["CONJ", ["SEQ", "fact", "\"+\"", "sum"]], ["DISJ", ["SEQ", "sum"]]],
    ["IMPL", ["CONJ", ["SEQ", "fact", "\"-\"", "sum"]], ["DISJ", ["SEQ", "sum"]]],
    ["IMPL", ["CONJ", ["SEQ", "fact"]], ["DISJ", ["SEQ", "sum"]]],
    ["IMPL", ["CONJ", ["SEQ", "primary", "\"*\"", "fact"]], ["DISJ", ["SEQ", "fact"]]],
    ["IMPL", ["CONJ", ["SEQ", "primary", "\"/\"", "fact"]], ["DISJ", ["SEQ", "fact"]]],
    ["IMPL", ["CONJ", ["SEQ", "primary"]], ["DISJ", ["SEQ", "fact"]]],
    ["IMPL", ["CONJ", ["SEQ", "/\\s*/", "alternate", "/\\s*/"]], ["DISJ", ["SEQ", "primary"]]],
    ["IMPL", ["CONJ", ["SEQ", "/[0-9]+/"]], ["DISJ", ["SEQ", "alternate"]]],
    ["IMPL", ["CONJ", ["SEQ", "\"(\"", "sum", "\")\""]], ["DISJ", ["SEQ", "alternate"]]]
]
</script>

<script id="math-exp example" type="text/plain">1 * 2 + (3 - 4 * 5) - 6 / 7</script>

<script id="NLP ruleset" type="text/plain">
["RULESET",
    ["IMPL", ["CONJ", ["SEQ", "S"]], ["DISJ", ["SEQ", "goal"]]],
    
    ["IMPL", ["CONJ", ["SEQ", "NP", "/\\s+/", "VP"]], ["DISJ", ["SEQ", "S"]]],
    ["IMPL", ["CONJ", ["SEQ", "Pronoun"]], ["DISJ", ["SEQ", "NP"]]],
    ["IMPL", ["CONJ", ["SEQ", "ProperNoun"]], ["DISJ", ["SEQ", "NP"]]],
    ["IMPL", ["CONJ", ["SEQ", "Det", "/\\s+/", "Nominal"]], ["DISJ", ["SEQ", "NP"]]],
    ["IMPL", ["CONJ", ["SEQ", "Verb"]], ["DISJ", ["SEQ", "VP"]]],
    ["IMPL", ["CONJ", ["SEQ", "Verb", "\\s+/", "NP"]], ["DISJ", ["SEQ", "VP"]]],
    ["IMPL", ["CONJ", ["SEQ", "Verb", "/\\s+/", "NP", "/\\s+/", "PP"]], ["DISJ", ["SEQ", "VP"]]],
    ["IMPL", ["CONJ", ["SEQ", "Verb", "/\\s+/", "PP"]], ["DISJ", ["SEQ", "VP"]]],
    ["IMPL", ["CONJ", ["SEQ", "Preposition", "/\\s+/", "NP"]], ["DISJ", ["SEQ", "PP"]]],
    ["IMPL", ["CONJ", ["SEQ", "Nominal", "/\\s+/", "Noun"]], ["DISJ", ["SEQ", "Nominal"]]],
    ["IMPL", ["CONJ", ["SEQ", "Noun"]], ["DISJ", ["SEQ", "Nominal"]]],

    ["IMPL", ["CONJ", ["SEQ", "\"FLIGHT\""]], ["DISJ", ["SEQ", "Noun"]]],
    ["IMPL", ["CONJ", ["SEQ", "\"BREEZE\""]], ["DISJ", ["SEQ", "Noun"]]],
    ["IMPL", ["CONJ", ["SEQ", "\"TRIP\""]], ["DISJ", ["SEQ", "Noun"]]],
    ["IMPL", ["CONJ", ["SEQ", "\"MORNING\""]], ["DISJ", ["SEQ", "Noun"]]],
    ["IMPL", ["CONJ", ["SEQ", "\"IS\""]], ["DISJ", ["SEQ", "Verb"]]],
    ["IMPL", ["CONJ", ["SEQ", "\"PREFER\""]], ["DISJ", ["SEQ", "Verb"]]],
    ["IMPL", ["CONJ", ["SEQ", "\"LIKE\""]], ["DISJ", ["SEQ", "Verb"]]],
    ["IMPL", ["CONJ", ["SEQ", "\"NEED\""]], ["DISJ", ["SEQ", "Verb"]]],
    ["IMPL", ["CONJ", ["SEQ", "\"WANT\""]], ["DISJ", ["SEQ", "Verb"]]],
    ["IMPL", ["CONJ", ["SEQ", "\"FLY\""]], ["DISJ", ["SEQ", "Verb"]]],
    ["IMPL", ["CONJ", ["SEQ", "\"ME\""]], ["DISJ", ["SEQ", "Pronoun"]]],
    ["IMPL", ["CONJ", ["SEQ", "\"I\""]], ["DISJ", ["SEQ", "Pronoun"]]],
    ["IMPL", ["CONJ", ["SEQ", "\"YOU\""]], ["DISJ", ["SEQ", "Pronoun"]]],
    ["IMPL", ["CONJ", ["SEQ", "\"IT\""]], ["DISJ", ["SEQ", "Pronoun"]]],
    ["IMPL", ["CONJ", ["SEQ", "\"ALASKA\""]], ["DISJ", ["SEQ", "ProperNoun"]]],
    ["IMPL", ["CONJ", ["SEQ", "\"BALTIMORE\""]], ["DISJ", ["SEQ", "ProperNoun"]]],
    ["IMPL", ["CONJ", ["SEQ", "\"LOS ANGELES\""]], ["DISJ", ["SEQ", "ProperNoun"]]],
    ["IMPL", ["CONJ", ["SEQ", "\"UNITED\""]], ["DISJ", ["SEQ", "ProperNoun"]]],
    ["IMPL", ["CONJ", ["SEQ", "\"AMERICAN\""]], ["DISJ", ["SEQ", "ProperNoun"]]],
    ["IMPL", ["CONJ", ["SEQ", "\"CHICAGO\""]], ["DISJ", ["SEQ", "ProperNoun"]]],
    ["IMPL", ["CONJ", ["SEQ", "\"THE\""]], ["DISJ", ["SEQ", "Det"]]],
    ["IMPL", ["CONJ", ["SEQ", "\"A\""]], ["DISJ", ["SEQ", "Det"]]],
    ["IMPL", ["CONJ", ["SEQ", "\"AN\""]], ["DISJ", ["SEQ", "Det"]]],
    ["IMPL", ["CONJ", ["SEQ", "\"THIS\""]], ["DISJ", ["SEQ", "Det"]]],
    ["IMPL", ["CONJ", ["SEQ", "\"THESE\""]], ["DISJ", ["SEQ", "Det"]]],
    ["IMPL", ["CONJ", ["SEQ", "\"THAT\""]], ["DISJ", ["SEQ", "Det"]]],
    ["IMPL", ["CONJ", ["SEQ", "\"FROM\""]], ["DISJ", ["SEQ", "Preposition"]]],
    ["IMPL", ["CONJ", ["SEQ", "\"TO\""]], ["DISJ", ["SEQ", "Preposition"]]],
    ["IMPL", ["CONJ", ["SEQ", "\"ON\""]], ["DISJ", ["SEQ", "Preposition"]]],
    ["IMPL", ["CONJ", ["SEQ", "\"NEAR\""]], ["DISJ", ["SEQ", "Preposition"]]]
]
</script>

<script id="NLP example" type="text/plain">I WANT A MORNING FLIGHT TO ALASKA</script>

<script id="s-expr ruleset" type="text/plain">
["RULESET",
    ["IMPL", ["CONJ", ["SEQ", "s-expr-ws"]], ["DISJ", ["SEQ", "goal"]]],
    
    ["IMPL", ["CONJ", ["SEQ", "/\\s*/", "s-expr", "/\\s*/"]], ["DISJ", ["SEQ", "s-expr-ws"]]],
    ["IMPL", ["CONJ", ["SEQ", "primary"]], ["DISJ", ["SEQ", "s-expr"]]],
    ["IMPL", ["CONJ", ["SEQ", "primary", "/\\s+/", "s-expr"]], ["DISJ", ["SEQ", "s-expr"]]],
    ["IMPL", ["CONJ", ["SEQ", "\"(\"", "/\\s*/", "\")\""]], ["DISJ", ["SEQ", "primary"]]],
    ["IMPL", ["CONJ", ["SEQ", "/[^\\s()]+/"]], ["DISJ", ["SEQ", "primary"]]],
    ["IMPL", ["CONJ", ["SEQ", "\"(\"", "s-expr-ws", "\")\""]], ["DISJ", ["SEQ", "primary"]]]
]
</script>

<script id="s-expr example" type="text/plain">(+ 3 5 (* 7 (- 8 9 10)))</script>

<script id="ambig ruleset" type="text/plain">
["RULESET",
    ["IMPL", ["CONJ", ["SEQ", "A"]], ["DISJ", ["SEQ", "goal"]]],

    ["IMPL", ["CONJ", ["SEQ", "A", "A"]], ["DISJ", ["SEQ", "A"]]],
    ["IMPL", ["CONJ", ["SEQ", "\"a\""]], ["DISJ", ["SEQ", "A"]]]
]
</script>

<script id="ambig example" type="text/plain">aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa</script>

<script id="exp-log ruleset" type="text/plain">
["RULESET",
    ["IMPL", ["CONJ", ["SEQ", " ", "explog", " "]], ["DISJ", ["SEQ", "goal"]]],
    
    ["IMPL", ["CONJ", ["SEQ", "variable", " ", "\"<-\"", " ", "explog"]], ["DISJ", ["SEQ", "explog"]]],
    ["IMPL", ["CONJ", ["SEQ", "variable"]], ["DISJ", ["SEQ", "explog"]]],

    ["IMPL", ["CONJ", ["SEQ", "identifier", " ", "\":\"", " ", "atom", " ", "\".\"", " ", "variable"]], ["DISJ", ["SEQ", "variable"]]],
    ["IMPL", ["CONJ", ["SEQ", "eq"]], ["DISJ", ["SEQ", "variable"]]],
    
    ["IMPL", ["CONJ", ["SEQ", "impl", " ", "\"<->\"", " ", "eq"]], ["DISJ", ["SEQ", "eq"]]],
    ["IMPL", ["CONJ", ["SEQ", "impl"]], ["DISJ", ["SEQ", "eq"]]],
    
    ["IMPL", ["CONJ", ["SEQ", "or", " ", "\"->\"", " ", "impl"]], ["DISJ", ["SEQ", "impl"]]],
    ["IMPL", ["CONJ", ["SEQ", "or"]], ["DISJ", ["SEQ", "impl"]]],
    
    ["IMPL", ["CONJ", ["SEQ", "and", " ", "\"\\/\"", " ", "or"]], ["DISJ", ["SEQ", "or"]]],
    ["IMPL", ["CONJ", ["SEQ", "and"]], ["DISJ", ["SEQ", "or"]]],
    
    ["IMPL", ["CONJ", ["SEQ", "seq", " ", "\"/\\\"", " ", "and"]], ["DISJ", ["SEQ", "and"]]],
    ["IMPL", ["CONJ", ["SEQ", "seq"]], ["DISJ", ["SEQ", "and"]]],

    ["IMPL", ["CONJ", ["SEQ", "prim", " ", "\"_\"", " ", "seq"]], ["DISJ", ["SEQ", "seq"]]],
    ["IMPL", ["CONJ", ["SEQ", "prim", " ", "seq"]], ["DISJ", ["SEQ", "seq"]]],
    ["IMPL", ["CONJ", ["SEQ", "prim"]], ["DISJ", ["SEQ", "seq"]]],

    ["IMPL", ["CONJ", ["SEQ", "\"(\"", " ", "explog", " ", "\")\""]], ["DISJ", ["SEQ", "prim"]]],
    ["IMPL", ["CONJ", ["SEQ", "atom"]], ["DISJ", ["SEQ", "prim"]]],

    ["IMPL", ["CONJ", ["SEQ", "identifier"]], ["DISJ", ["SEQ", "atom"]]],
    ["IMPL", ["CONJ", ["SEQ", "literal"]], ["DISJ", ["SEQ", "atom"]]],

    ["IMPL", ["CONJ", ["SEQ", "/[A-Za-z][A-Za-z0-9]*/"]], ["DISJ", ["SEQ", "identifier"]]],

    ["IMPL", ["CONJ", ["SEQ", "/\\/(?!\\*)(?!\\/)([^\\n\\/\\\\]|(\\\\.))*\\/i?/"]], ["DISJ", ["SEQ", "literal"]]],
    ["IMPL", ["CONJ", ["SEQ", "/\"([^\"\\\\\\n]|(\\\\.))*\"/"]], ["DISJ", ["SEQ", "literal"]]],

    ["IMPL", ["CONJ", ["SEQ", "/((\\s+)|(\\/\\/((.*\\n)|(.*$)))|(\\/\\*[\\S\\s]*?\\*\\/))*/"]], ["DISJ", ["SEQ", " "]]]
]
</script>

<script id="exp-log example" type="text/plain">/*
    UNTYPED LAMBDA CALCULUS
    
    input: lambda expression
    output: evaluated expression
*/

(
    lterm -> goal
) /\ (
    (
        // base syntax
        (                   appl -> lterm ) /\
        (              appl prim -> appl  ) /\
        (                   prim -> appl  ) /\
        (          "(" lterm ")" -> prim  ) /\
        (                    var -> prim  ) /\
        ( /[A-Za-z][0-9A-Za-z]*/ -> var   )
    ) /\ (
        // semantics
        (
            // beta reduction
            X:var . M:lterm . N:lterm . (
                (
                    (aconv X M) N -> M
                ) /\ (
                    X -> N
                )
            )
        ) /\ (
            // alpha conversion
            X:var . M:lterm . Y:var . (
                (
                    "λ" X "." M -> aconv Y M
                ) /\ (
                    X -> Y
                )
            )
        )
    )
)
</script>

<script id="esyn ruleset" type="text/plain">// elog
(                               variable -> goal       ) /\
( identifier ":" identifier "." variable -> variable   ) /\
(                                     eq -> variable   ) /\
(                    identifier "<->" eq -> eq         ) /\
(                             identifier -> eq         ) /\
(                 /[A-Za-z][A-Za-z0-9]*/ -> identifier )
</script>

<script id="esyn example" type="text/plain">a<->b<->c</script>

<script id="lsyn ruleset" type="text/plain">// lambda calculus syntax
(                  lterm -> goal  ) /\
(                   abst -> lterm ) /\
(       "λ" var "." abst -> abst  ) /\
(                   appl -> abst  ) /\
(        appl /\s+/ prim -> appl  ) /\
(                   prim -> appl  ) /\
(          "(" lterm ")" -> prim  ) /\
(                    var -> prim  ) /\
( /[A-Za-z][0-9A-Za-z]*/ -> var   )
</script>

<script id="lsyn example" type="text/plain">(λx.λy.(x y)) a b</script>

<script id="isyn ruleset" type="text/plain">// implicational logic syntax
(                   ilog -> goal ) /\
(                   impl -> ilog ) /\
(         prim "->" impl -> impl ) /\
(                   prim -> impl ) /\
(           "(" impl ")" -> prim ) /\
( /[A-Za-z][0-9A-Za-z]*/ -> prim )
</script>

<script id="isyn example" type="text/plain">(a->b)->c</script>

<script id="el ruleset" type="text/plain">a+b</script>

<script id="proplog example" type="text/plain">((a → ⊥) → ⊥)</script>

<script id="proplog ruleset" type="text/plain">/*
    IMPLICATIONAL PROPOSITIONAL LOGIC ENTSCHEIDUNGSMASCHINE
    (unavailable until the final exp-log version)
    
    input: implicational logic theorem
    output: "valid"
*/

(
    "valid" -> goal
) /\ (
    (
        // syntax
        (                   impl -> ilog ) /\
        (  "(" prim "→" impl ")" -> impl ) /\
        (                   prim -> impl ) /\
        ( /[A-Za-z][0-9A-Za-z]*/ -> prim ) /\
        (                    "⊥" -> prim )
    ) /\ (
        // semantics
        (
            A:ilog . B:ilog . (
                ("(" A "→" B ")" /\ A) -> (B -> "valid")
            )
        ) /\ (
            A:ilog . B:ilog . (
                "(" A "→" "(" B "→" A ")" ")"
            )
        ) /\ (
            A:ilog . B:ilog . C:ilog . (
                "(" "(" A "→" "(" B "→" C ")" ")" "→" "(" "(" A "→" B ")" "→" "(" A "→" C ")" ")" ")"
            )
        ) /\ (
            A:ilog . B:ilog . (
                "(" "(" "(" A "→" "⊥" ")" "→" "(" B "→" "⊥" ")" ")" "→" "(" B "→" A ")" ")"
            )
        )
    )
)
</script>

<script id="lambda example" type="text/plain">(λx.λy.(x y)) a b</script>

<script id="lambda ruleset" type="text/plain">/*
    UNTYPED LAMBDA CALCULUS
    (unavailable until the final exp-log version)
    
    input: lambda expression
    output: evaluated expression
*/

(
    lterm -> goal
) /\ (
    (
        // base syntax
        (                   appl -> lterm ) /\
        (              appl prim -> appl  ) /\
        (                   prim -> appl  ) /\
        (          "(" lterm ")" -> prim  ) /\
        (                    var -> prim  ) /\
        ( /[A-Za-z][0-9A-Za-z]*/ -> var   )
    ) /\ (
        // semantics
        (
            // beta reduction
            X:var . M:lterm . N:lterm . (
                (
                    (aconv X M) N -> M
                ) /\ (
                    X -> N
                )
            )
        ) /\ (
            // alpha conversion
            X:var . M:lterm . Y:var . (
                (
                    "λ" X "." M -> aconv Y M
                ) /\ (
                    X -> Y
                )
            )
        )
    )
)
</script>

<script id="turing example" type="text/plain"> s 0 => 0 R s  ,
 s 1 => 1 R s  ,
s () => () L a ,

 a 1 => 0 L a  ,
 a 0 => 1 R f  ,

 f 0 => 0 R f  ,
 f 1 => 1 R f  ,

f () => () h   :

() s 1 0 0 1 ()
</script>

<script id="turing ruleset" type="text/plain">/*
    UNIVERSAL TURING MACHINE
    (unavailable until the final exp-log version)
    
    input: set of instructions and initial tape states
    output: resulting tape states after halting instruction
*/

(
    tape -> goal
) /\ (
    (
        // syntax
        (
            // tape syntax
            (  ( tape cell \/ cell ) -> tape  ) /\
            (        ( bit \/ head ) -> cell  ) /\
            (              state bit -> head  ) /\
            (                /[a-z]/ -> state ) /\
            ( ( "0" \/ "1" \/ "()" ) -> bit   )
        ) /\ (
            // instructions syntax
            ( ( instruction "," sequence \/ instruction ) -> sequence    ) /\
            (       "(" head "=>" bit direction state ")" -> instruction ) /\
            (                                  ( l \/ r ) -> direction   )
        )
    ) /\ (
        //semantics
        (
            // extracting each instruction and the tape from input
            I:instruction . S:sequence . T:tape . (
                ( I "," S ":" T -> ( ins I /\ S ":" T ) ) /\
                (       I ":" T -> ( ins I /\ tp T    ) )
            )
        ) /\ (
            // applying instructions on tape
            (
                // changing bit and state, and moving head to the right
                Preb:bit . Pres:state . Sufb:bit . Newb:bit . News:state . T:tape . (
                    ins (Pres Preb "=>" Newb r News) -> (
                        tp ((T (Pres Preb)) Sufb) -> tp ((T Newb) (News Sufb))
                    )
                )
            ) /\ (
                // changing bit and state, and moving head to the left
                Preb:bit . Sufb:bit . Sufs:state . Newb:bit . News:state . T:tape . (
                    ins (Sufs Sufb "=>" Newb l News) -> (
                        tp ((T Preb) (Sufs Sufb)) -> tp ((T (News Preb)) Newb)
                    )
                )
            )
        ) /\ (
            // extracting solution
            T:tape . (
                tp (T ("h" "()")) -> T "()"
            )
        )
    )
)
</script>

<script id="expert system" type="text/plain">(
    ((@a -> @b) (@a @b)) (
        ((@a /\ @b) -> @a) (
            ((@a /\ @b) -> @b) (
                (
                    (feeding tactics) -> (
                        (
                            (pray is not alive) -> (
                                (scavenging)
                            )
                        ) /\ (
                            (pray is alive) -> (
                                (
                                    (pray stays alive) -> (
                                        (
                                            (pray is a host) -> (
                                                (parasitism)
                                            )
                                        ) /\ (
                                            (pray is not a host) -> (
                                                (browsing)
                                            )
                                        )
                                    )
                                ) /\ (
                                    (pray doesn't stay alive) -> (
                                        (
                                            (pray is a host) -> (
                                                (parasitoidism)
                                            )
                                        ) /\ (
                                            (pray is not a host) -> (
                                                (
                                                    (pray is fleeing) -> (
                                                        (predation)
                                                    )
                                                ) /\ (
                                                    (pray is not fleeing) -> (
                                                        (grazing)
                                                    )
                                                )
                                            )
                                        )
                                    )
                                )
                            )
                        )
                    )
                ) (
                    (
                        (
                            feeding tactics
                        ) /\ (
                            pray is alive
                        ) /\ (
                            pray stays alive
                        ) /\ (
                            pray is not a host
                        )
                    ) (expert system)
                )
            )
        )
    )
)</script>

<script>
    function populate (param) {
        ruleset1.getSession().setValue(document.getElementById(param + ' ruleset').innerHTML);
        input1.getSession().setValue(document.getElementById(param + ' example').innerHTML);
        output1.getSession().setValue("");
        nodes1.getSession().setValue("");
    }
    
    cr = String.fromCharCode(13);
    
    var parsed;

    function outputErrors (parsed) {
        for (i = 0; i < parsed.expected.length; i++) {
            output1.getSession().setValue(output1.getSession().getValue() + "    " + parsed.expected[i]);
            if (i < parsed.expected.length - 1)
                output1.getSession().setValue(output1.getSession().getValue() + " or " + String.fromCharCode(13));
        }
            
        output1.getSession().setValue(output1.getSession().getValue() + String.fromCharCode(13));
    }
    
    var inProcess = false;
    function startParse () {
        if (!inProcess) {
            inProcess = true;
            //document.getElementById('forestOut').style.display = 'none';
            //document.getElementById('forestOut').style.display = 'inline';
            output1.getSession().setValue("");
            var grammarstring = ruleset1.getSession().getValue();
            var inputstring = input1.getSession().getValue();

            nodes1.getSession().setValue("");
            output1.getSession().setValue("Reading branching rules... ");
            output1.gotoLine(0);
            nodes1.gotoLine(0);
            setTimeout (function (){
                var time = new Date().getTime();
                try {
                    rules = JSON.parse (grammarstring);
                } catch (e) {
                    output1.getSession().setValue(output1.getSession().getValue() + String.fromCharCode(13));
                    output1.getSession().setValue(output1.getSession().getValue() + "Error in ruleset:" + String.fromCharCode(13));
                    output1.getSession().setValue(output1.getSession().getValue() + e.message + String.fromCharCode(13));
                    inProcess = false;
                    return;
                }
                
                output1.getSession().setValue(output1.getSession().getValue() + "done, " + ((new Date().getTime()) - time) + "ms." + String.fromCharCode(13));
                output1.getSession().setValue(output1.getSession().getValue() + "Processing input...");
                setTimeout (function (){
                    var time = new Date().getTime();

                    parsed = parser.getParseTree (rules, inputstring);
                    if (!parsed.success) {
                        output1.getSession().setValue(output1.getSession().getValue() + String.fromCharCode(13));
                        output1.getSession().setValue(output1.getSession().getValue() + "Error in ruleset at offset " + parsed.offset + " (row: " + parsed.row + ", col: " + parsed.column + ")," + String.fromCharCode(13));
                        output1.getSession().setValue(output1.getSession().getValue() + "expected: " + String.fromCharCode(13));
                        outputErrors (parsed);
                        inProcess = false;

                    } else {
                        setTimeout (function (){
                            //output1.getSession().setValue(output1.getSession().getValue() + "Extracting output..." + String.fromCharCode(13));
                            output1.getSession().setValue(output1.getSession().getValue() + "done, " + ((new Date().getTime()) - time) + "ms." + String.fromCharCode(13));
                            output1.getSession().setValue(output1.getSession().getValue() + "Writing branching nodes... ");
                            setTimeout (function (){
                                var time = new Date().getTime();
                                var nd = JSON.stringify (parsed.parseTree, null, 2);
                                var op = JSON.stringify (parsed.sexpr, null, 2);
                                output1.getSession().setValue(output1.getSession().getValue() + "done, " + ((new Date().getTime()) - time) + "ms." + String.fromCharCode(13));
                                nodes1.getSession().setValue(nd);
                                output1.getSession().setValue(output1.getSession().getValue() + op);
                            }, 0);
                            inProcess = false;
                        }, 0);
                    }
                }, 0);
            }, 0);
        }
    }
</script>

<style type="text/css" media="screen">
    /*
    @font-face {
        font-family: 'Fira';
        src: url('FiraCode-Regular.ttf');
    }
    */
    
    html, body
    {
        overflow: hidden;
        height: 100%;
        width: 100%;
        margin-top: 0px;
        margin-left: 0px;
        background-color: white;
    }
    #ruleset1 {
        position:relative;
        width: 100%;
        height: 100%;
    }
    #input1 {
        position: relative;
        width: 100%;
        height: 100%;
        display: block;
    }
    #output1 {
        position: relative;
        width: 100%;
        height: 100%;
        display: block;
    }
    #nodes1 {
        position: relative;
        width: 100%;
        height: 100%;
        display: block;
    }
    
    #title  {color: #555555;}
    #foot   {color: #000000;}
    #all    {border-radius: 15px; border-spacing: 0px; border:0px solid #555555; color:#EEEEEE; background-color:#555555;}
    #top    {border-radius: 15px 15px 0px 0px; border-spacing: 0px; border:0px; color:#EEEEEE; background-color:#555555;}
    #bot    {border-radius: 0px 0px 15px 15px; border-spacing: 0px; border:0px; color:#EEEEEE; background-color:#555555;}
    #none   {border-radius: 0px 0px 0px 0px; color:#EEEEEE; background-color:#555555;}
    #in     {border:1px solid #555555; border-spacing: 0px; color:#EEEEEE; background-color:gray;}
    #dark   {border-spacing: 0px; border-left: 1px solid #4466DD; border-right: 1px solid #4466DD; border-bottom: 1px solid #4466DD; color:#DDEEFF; background-color:#334488;}

    a.exHover:visited, a.exHover:link {cursor: pointer; background-color: #333333; color:#EEEEEE; text-decoration:none; border-radius: 15px;}
    a.exHover:hover {cursor: pointer; background-color: #999999; color:#EEEEEE; text-decoration:none; border-radius: 15px;}
    a.exHover:active {cursor: pointer; background-color: #DDDDDD; color:#FFFFFF; text-decoration:none; border-radius: 15px;}
    a {text-align: center;}

    .dropbtn:visited {cursor: pointer; background-color: #333333; color:#EEEEEE; text-decoration:none; border-radius: 15px;}
    .dropbtn:link {cursor: pointer; background-color: #333333; color:#EEEEEE; text-decoration:none; border-radius: 15px;}
    .dropbtn:hover {cursor: pointer; background-color: #999999; color:#EEEEEE; text-decoration:none; border-radius: 15px;}
    .dropbtn:active {cursor: pointer; background-color: #DDDDDD; color:#FFFFFF; text-decoration:none; border-radius: 15px;}
    .dropbtn {
      text-align: left;
    }

    .dropdown {
      position: relative;
      display: inline-block;
    }

    .dropdown-content {
      border-radius: 7px;
      display: none;
      position: absolute;
      background-color: #333333;
      min-width: 300px;
      overflow: auto;
      box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
      z-index: 65525;
    }

    .dropdown-content a {
      text-align: left;
      color: #EEEEEE;
      padding: 12px 12px;
      text-decoration: none;
      display: block;
    }

    .dropdown-content div {
      text-align: left;
      color: #AAAAAA;
      padding: 12px 12px;
      text-decoration: none;
      display: block;
    }

    .dropdown a:hover {background-color: #999999;}
    .dropdown a:active {cursor: pointer; background-color: #DDDDDD; color:#FFFFFF; text-decoration:none;}

    .show {display: block;}
</style>
</head>
<body style="font-family: Arial, Helvetica, sans-serif;">
<table width="100%" height="100%" align="center" valign="middle" cellspacing="0" cellpadding="0" border="10px" style="border: 10px solid white;">
<tbody>
<tr>
<td class="exRound" id="top" cellpadding="10" align="center" valign="middle" height="30">
<font size="5"><strong>v-parse-crux algorithm playground</strong></font>
</td>
</tr>
<tr>
<td id="in">
    <table width="100%" cellspacing="10" cellpadding="0" height="100%" border="0">
        <tbody><tr>
        <td width="33.33%"">
            <table width="100%" cellspacing="0" cellpadding="0" height="100%" border="0">
            <tbody><tr>
             <td class="exRound" id="top" valign="middle" height="30">
                <font size="2">
                <b>
<div class="dropdown">
                  &nbsp; &nbsp; 1. branching rules: &nbsp;
                  <a id="mdd" onclick="myFunction()" href="javascript:void(null);" class="dropbtn">
                    &nbsp; examples &nbsp;
                  </a> &nbsp;
    <div id="myDropdown" class="dropdown-content">
        <div class="droplbl">context free grammars</div>
        <a href="javascript:populate('math-exp');">&nbsp;&nbsp;&nbsp; math expression</a>
        <a href="javascript:populate('NLP');">&nbsp;&nbsp;&nbsp; natural language</a>
        <a href="javascript:populate('s-expr');">&nbsp;&nbsp;&nbsp; s-expression</a>
        <a href="javascript:populate('ambig');">&nbsp;&nbsp;&nbsp; ambiguity test</a>
        <a href="javascript:populate('exp-log');">&nbsp;&nbsp;&nbsp; expression logic</a>
        
        <!--div class="droplbl">computation (unavailable)</div>
        <a href="javascript:populate('proplog');">&nbsp;&nbsp;&nbsp; implicational logic</a>
        <a href="javascript:populate('lambda');">&nbsp;&nbsp;&nbsp; lambda calculus</a>
        <a href="javascript:populate('turing');">&nbsp;&nbsp;&nbsp; Turing machine</a-->
    </div>
</div>
                </b>
                </font>
             </td>
            </tr>
            <tr height="100%">
             <!-- style="margin-top:-8px;"-->
             <td class="exRound" id="in" valign="top">
                <div id="ruleset1" class=" ace_editor  ace-solarized-dark ace_dark"></div>
                <script>
                    ruleset1 = ace.edit("ruleset1");
                    ruleset1.$blockScrolling = Infinity;
                    ruleset1.setTheme("ace/theme/dark");
                    ruleset1.setHighlightSelectedWord(false);
                    ruleset1.setShowPrintMargin(false);
                    ruleset1.getSession().setUseSoftTabs(true);
                    ruleset1.getSession().selection.on('changeCursor', function(e) {
                        document.getElementById('lblGrammarCaret').innerHTML = "(" + (ruleset1.getCursorPosition().row + 1) + ", " + (ruleset1.getCursorPosition().column + 1) + ")&nbsp;";
                    });
                    ruleset1.getSession().on('change', function(e) {
                        //document.getElementById('forestOut').style.display = 'none';
                    });
                    ruleset1.setOptions({
                        fontFamily: "monospace",
                        fontSize: "8pt"
                    });
                </script>
             </td>
            </tr>
            <tr>
              <td class="exRound" id="bot" height="5" align="right">
               <font size="1">
                <label id="lblGrammarCaret">(1, 1)</label>&nbsp;&nbsp;&nbsp;
               </font>
              </td>
            </tr>
            </tbody></table>
        </td>
        <td width="33.33%" height="100%" cellspacing="0" cellpadding="0">
          <table width="100%" cellspacing="0" cellpadding="0" height="100%" border="0">
          <tbody><tr>
          <td>
            <table width="100%" cellspacing="0" cellpadding="0" height="100%" border="0">
            <tbody>
            <tr height="50%">
             <td style="padding-bottom: 5px;">
              <table width="100%" cellspacing="0" cellpadding="0" height="100%" border="0">
                <tbody>
                <tr>
                  <td class="exRound" id="top" height="30">
                      <font size="2">
                      <b>
                      &nbsp; &nbsp; 2. input: &nbsp;
                      </b>
                      <br>
                      </font>
                  </td>
                </tr>
                <tr height="100%">
                  <td class="exRound" id="in">
                    <div id="input1" class=" ace_editor ace-solarized-dark ace_dark"></div>
                    <script>
                        input1 = ace.edit("input1");
                        input1.$blockScrolling = Infinity;
                        input1.setTheme("ace/theme/dark");
                        //input1.renderer.setShowGutter(false);
                        input1.setHighlightSelectedWord(false)
                        input1.setShowPrintMargin(false);
                        input1.getSession().selection.on('changeCursor', function(e) {
                            document.getElementById('lblInputCaret').innerHTML = "(" + (input1.getCursorPosition().row + 1) + ", " + (input1.getCursorPosition().column + 1) + ")&nbsp;";
                        });
                        input1.getSession().on('change', function(e) {
                            //document.getElementById('forestOut').style.display = 'none';
                        });
                        //input1.setReadOnly(true);
                        input1.setOptions({
                            fontFamily: "monospace",
                            fontSize: "8pt"
                        });
                    </script>
                  </td>
                </tr>
                <tr>
                  <td class="exRound" id="bot" height="5" align="right">
                   <font size="1">
                    <label id="lblInputCaret">(1, 1)</label>&nbsp;&nbsp;&nbsp;
                   </font>
                  </td>
                </tr>
                </tbody>
              </table>
             </td>
            </tr>
            <tr height="50%">
             <td style="padding-top: 5px;">
              <table width="100%" cellspacing="0" cellpadding="0" height="100%" border="0">
                <tbody>
                  <tr>
                    <td class="exRound" id="top" height="30">
                      <font size="2">
                      <b>
                      &nbsp; &nbsp; 3. output: &nbsp;
                        <a onclick="startParse()" class="exHover" href="javascript:void(null);">
                        &nbsp; generate &nbsp;
                        </a> &nbsp;
                        <!--a id="forestOut" onclick="outputForest()" class="exHover" href="javascript:void(null);" style="display: none;">
                        &nbsp; generate leaves &nbsp;
                        </a-->
                      </b>
                      <br>
                      </font>
                    </td>
                  </tr>
                  <tr height="100%">
                    <td class="exRound" id="in" style="border-radius: 0px 0px 15px 15px;">
                      <div id="output1" class=" ace_editor ace-solarized-light ace_dark" style="border-radius: 0px 0px 14px 14px;"></div>
                      <script>
                        output1 = ace.edit("output1");
                        output1.$blockScrolling = Infinity;
                        output1.setTheme("ace/theme/light");
                        //output1.renderer.setShowGutter(false);
                        output1.setHighlightSelectedWord(false);
                        output1.setShowPrintMargin(false);
                        output1.setReadOnly(true);
                        output1.setOptions({
                            fontFamily: "monospace",
                            fontSize: "8pt"
                        });
                      </script>
                    </td>
                  </tr>
                </tbody>
              </table>
             </td>
            </tr>
           </tbody></table>
          </td>
          </tr>
          
          </tbody></table>
        </td>
        <td width="33.33%" height="100%">
            <table width="100%" cellspacing="0" cellpadding="0" height="100%" border="0">
            <tbody><tr>
             <td class="exRound" id="top" valign="middle" height="30">
                <font size="2">
                <b>
                  &nbsp; &nbsp; 4. branching nodes: &nbsp;
                  <a onclick="nodes1.getSession().foldAll()" class="exHover" href="javascript:void(null);">
                    &nbsp; collapse all &nbsp;
                  </a> &nbsp;
                  <a onclick="nodes1.getSession().unfold()" class="exHover" href="javascript:void(null);">
                    &nbsp; expand all &nbsp;
                  </a> &nbsp;
                </b>
                </font>
             </td>
            </tr>
            <tr height="100%">
             <td class="exRound" id="in" style="border-radius: 0px 0px 15px 15px;">
              <div id="nodes1" class=" ace_editor ace-solarized-light ace_dark" style="border-radius: 0px 0px 14px 14px;"></div>
              <script>
                nodes1 = ace.edit("nodes1");
                nodes1.$blockScrolling = Infinity;
                nodes1.getSession().setMode("ace/mode/json");
                //editor.getSession().setUseWrapMode(true);
                nodes1.setTheme("ace/theme/light");
                //nodes1.renderer.setShowGutter(false);
                nodes1.setHighlightSelectedWord(false);
                nodes1.setShowPrintMargin(false);
                nodes1.setReadOnly(true);
                nodes1.setOptions({
                    fontFamily: "monospace",
                    fontSize: "8pt"
                });
              </script>
             </td>
            </tr>
            </tbody></table>
        </td>
        </tr>
    </tbody></table>
</td>
</tr>
<tr>
 <td id="bot" valign="middle" height="30">
    <table width="100%" height="100%">
    <tr>
        <td align="left">
            <font size="2">
                &nbsp; &nbsp; <a href="https://github.com/ajaxorg/ace" style="color:white;">powered by ACE editor</a>
            </font>
        </td>
        <td align="right">
            <font size="3">
              <b>
                <a class="exHover" href="https://github.com/contrast-zone/exp-log" target="new">
                &nbsp; visit me on GitHub &nbsp;
                </a>
                &nbsp; &nbsp;
              </b>
            </font>
        </td>
    </tr>
    </table>
 </td>
</tr>
</tbody>
</table>

<script>
    populate ('math-exp');
</script>

<script>
    /* When the user clicks on the button, 
    toggle between hiding and showing the dropdown content */
    function myFunction() {
      document.getElementById("myDropdown").draggable = false;
      document.getElementById("myDropdown").ondragstart = function () {return false};
            
      document.getElementById("myDropdown").style.left = document.getElementById("mdd").offsetLeft + "px";
      document.getElementById("myDropdown").style.top = document.getElementById("mdd").offsetTop + document.getElementById("mdd").offsetHeight + 3 + "px";
      
      document.getElementById("myDropdown").classList.toggle("show");
    }

    // Close the dropdown if the user clicks outside of it
    window.onclick = function(event) {
      if (!event.target.matches('.dropbtn') && !event.target.matches('.droplbl')) {
        var dropdowns = document.getElementsByClassName("dropdown-content");
        var i;
        for (i = 0; i < dropdowns.length; i++) {
          var openDropdown = dropdowns[i];
          if (openDropdown.classList.contains('show')) {
            openDropdown.classList.remove('show');
          }
        }
      }
    }
</script>

</body>
</html>

